{% extends template('widget') %}

{% define data = {
    navigation: navigation,
} %}

{% block body %}
    {% set hasIcons = false %}
    {% set title = '' %}

    <pre>{{ dump(data.navigation | length) }}</pre>
    {% for node in data.navigation.nodes %}
        {% set nodeType = node.nodeType %}

        {% if nodeType == 'cms_page' %}
            {% set title = 'footer.navigation_title.legal_information' | trans %}
        {% endif %}

        {% if nodeType == 'external_url' %}
            {% set title = 'footer.navigation_title.information' | trans %}
        {% endif %}

        {% if nodeType == 'label' %}
            {% set hasIcons = true %}
            {% set title = 'footer.navigation_title.customer_service' | trans %}
        {% endif %}
    {% endfor %}

    {% set triggerClass = 'js-navigation-footer__trigger--' ~ title | lower | replace(' ', '-') %}
    {% set targetClass = 'js-navigation-footer__target--' ~ title | lower | replace(' ', '-') %}
    {% set itemClass = 'navigation-footer__col' %}
    {% set itemContentHiddenClass = 'is-hidden-sm-only' %}

    {% embed molecule('toggler-item') with {
        modifiers: ['mobile', 'footer'],
        class: itemClass,
        data: {
            title: title,
            triggerClass: triggerClass,
            targetClass: targetClass,
            hiddenClass: itemContentHiddenClass,
        },
        embed: {
            nodes: data.navigation.nodes,
            hasIcons: hasIcons,
        },
    } only %}
        {% block contentText %}
            {% if not embed.hasIcons %}
                {% include molecule('navigation-list') with {
                    modifiers: ['footer'],
                    data: {
                        nodes: embed.nodes,
                    },
                } only %}
            {% endif %}

            {% if embed.hasIcons %}
                {% embed molecule('navigation-icon-list') with {
                    data: {
                        nodes: embed.nodes,
                    },
                } only %}
                    {% block body %}
                        {% set menuClass = 'menu' %}

                        {{ parent() }}
                    {% endblock %}
                {% endembed %}
            {% endif %}
        {% endblock %}
    {% endembed %}
{% endblock %}
