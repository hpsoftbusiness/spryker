{% extends template('page-layout-checkout', 'CheckoutPage') %}

{% define data = {
    backUrl: _view.previousStepUrl,
    title: 'checkout.step.benefit_deal.title' | trans
} %}

{% block content %}
    <h2 class="title title--primary">{{ 'checkout.step.benefit_deal.title' | trans }}</h2>

    {% embed molecule('form') with {
        modifiers: ['checkout-actions', 'checkout-form-elements'],
        data: {
            form: _view.benefit_deal_collection_form,
            benefitSalesInfo: _view.benefitSalesInfo,
            benefitVouchersCurrencyCode: _view.customerBalance.benefitVouchersCurrencyCode,
            submit: {
                enable: true,
                text: 'checkout.step.payment' | trans,
                class: 'form__action--checkout button  button--large button--expand  js-payment-form__submit',
            },
            cancel: {
                enable: true,
                url: data.backUrl,
                text: 'general.back.button' | trans,
                class: 'form__action--checkout button button--hollow button--expand',
            },
        },
    } only %}
        {% block fieldset %}
            <div>
                {% for key, item in data.form.benefitItems %}
                    {% include molecule('benefit-product-item', 'CheckoutPage') with {
                        data: {
                            item: item,
                            formType: item.children | keys | first,
                            product: item.vars.value,
                            benefitSalesInfo: data.benefitSalesInfo,
                            benefitVouchersCurrencyCode: data.benefitVouchersCurrencyCode,
                        },
                    } only %}
                {% endfor %}
            </div>
        {% endblock %}
    {% endembed %}
{% endblock %}
